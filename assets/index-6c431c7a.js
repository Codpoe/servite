import{c as U,j as R,a as O}from"./Link-0bd7b5eb.js";import{r as m}from"./islands-8f4b852a.js";import{L as F}from"./index-492a208b.js";var H=typeof global=="object"&&global&&global.Object===Object&&global;const _=H;var G=typeof self=="object"&&self&&self.Object===Object&&self,X=_||G||Function("return this")();const C=X;var D=C.Symbol;const h=D;var M=Object.prototype,Y=M.hasOwnProperty,q=M.toString,y=h?h.toStringTag:void 0;function z(t){var e=Y.call(t,y),n=t[y];try{t[y]=void 0;var i=!0}catch{}var a=q.call(t);return i&&(e?t[y]=n:delete t[y]),a}var J=Object.prototype,K=J.toString;function Q(t){return K.call(t)}var V="[object Null]",Z="[object Undefined]",L=h?h.toStringTag:void 0;function tt(t){return t==null?t===void 0?Z:V:L&&L in Object(t)?z(t):Q(t)}function et(t){return t!=null&&typeof t=="object"}var nt="[object Symbol]";function rt(t){return typeof t=="symbol"||et(t)&&tt(t)==nt}var it=/\s/;function ot(t){for(var e=t.length;e--&&it.test(t.charAt(e)););return e}var at=/^\s+/;function ct(t){return t&&t.slice(0,ot(t)+1).replace(at,"")}function v(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var N=0/0,st=/^[-+]0x[0-9a-f]+$/i,ft=/^0b[01]+$/i,lt=/^0o[0-7]+$/i,ut=parseInt;function k(t){if(typeof t=="number")return t;if(rt(t))return N;if(v(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=v(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=ct(t);var n=ft.test(t);return n||lt.test(t)?ut(t.slice(2),n?2:8):st.test(t)?N:+t}var dt=function(){return C.Date.now()};const E=dt;var gt="Expected a function",mt=Math.max,pt=Math.min;function W(t,e,n){var i,a,f,l,c,o,s=0,T=!1,g=!1,u=!0;if(typeof t!="function")throw new TypeError(gt);e=k(e)||0,v(n)&&(T=!!n.leading,g="maxWait"in n,f=g?mt(k(n.maxWait)||0,e):f,u="trailing"in n?!!n.trailing:u);function p(r){var d=i,b=a;return i=a=void 0,s=r,l=t.apply(b,d),l}function S(r){return s=r,c=setTimeout(x,e),T?p(r):l}function A(r){var d=r-o,b=r-s,w=e-d;return g?pt(w,f-b):w}function $(r){var d=r-o,b=r-s;return o===void 0||d>=e||d<0||g&&b>=f}function x(){var r=E();if($(r))return I(r);c=setTimeout(x,A(r))}function I(r){return c=void 0,u&&i?p(r):(i=a=void 0,l)}function B(){c!==void 0&&clearTimeout(c),s=0,i=o=a=c=void 0}function P(){return c===void 0?l:I(E())}function j(){var r=E(),d=$(r);if(i=arguments,a=this,o=r,d){if(c===void 0)return S(o);if(g)return clearTimeout(c),c=setTimeout(x,e),p(o)}return c===void 0&&(c=setTimeout(x,e)),l}return j.cancel=B,j.flush=P,j}var bt="Expected a function";function yt(t,e,n){var i=!0,a=!0;if(typeof t!="function")throw new TypeError(bt);return v(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),W(t,e,{leading:i,maxWait:e,trailing:a})}function Tt(t){m.exports.useEffect(()=>(window.addEventListener("scroll",t),()=>{window.removeEventListener("scroll",t)}),[t])}function Et(){var c;const t=(c=U().pageModule)==null?void 0:c.toc,[e,n]=m.exports.useState([]),[i,a]=m.exports.useState(-1),f=m.exports.useRef(null);m.exports.useEffect(()=>{const o=t==null?void 0:t.map(({id:s})=>document.getElementById(s)).filter(s=>!!s);n(o||[]),a(-1)},[t]);const l=m.exports.useCallback(yt(()=>{if(!f.current||!e.length)return;if(ht()===0){a(-1);return}const s=e.findIndex((T,g)=>{const u=e[g+1],{top:p}=T.getBoundingClientRect(),{top:S}=(u==null?void 0:u.getBoundingClientRect())||{};return p<=100&&(!u||S>100)});a(s)},50,{trailing:!0}),[e]);return Tt(l),m.exports.useEffect(()=>{var o;xt((o=e[i])==null?void 0:o.id)},[e,i]),R("div",{ref:f,children:[O("div",{className:"mb-2 text-xs text-c-text-0 font-bold",children:"目录"}),R("div",{className:"relative",children:[O("div",{className:`absolute -left-3 w-1 h-5 rounded bg-c-brand transition-all
          ${i>=0?"opacity-100":"opacity-0"}`,style:{top:`${Math.max(i*28,0)+4}px`}}),t==null?void 0:t.map((o,s)=>O(F,{id:vt(s),className:`block truncate text-sm leading-7 font-medium text-c-text-1 transition-opacity
              ${s===i?"opacity-100":"opacity-60 hover:opacity-100"}`,to:`#${o.id}`,color:!1,style:{paddingLeft:`${(o.depth-2)*12}px`},children:o.text},s))]})]})}const xt=W(t=>{window.history.replaceState(void 0,"",t?`#${t}`:" ")},700);function ht(){return Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)}function vt(t){return`toc-item-${t}`}export{Et as Toc};
