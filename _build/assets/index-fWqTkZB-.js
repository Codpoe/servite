import{r as n,j as o}from"./jsx-runtime-OjB1YB6s.js";import{L as y}from"./router-CHubS-Eh.js";import{u as j,t as w,g as E}from"./layout-CHrwosYp.js";import"./index-Bfd0p7Qn.js";import"./preload-helper-BrvI3jIZ.js";import"./index-Crl2ozBJ.js";function S({className:r=""}){const l=j(),c=n.useMemo(()=>l.toc?.filter(t=>t.depth>1),[l.toc]),[d,m]=n.useState([]),[i,a]=n.useState(-1),u=n.useRef(null),s=n.useRef(d);return s.current=d,n.useEffect(()=>{const t=c?.map(({id:e})=>document.getElementById(e)).filter(e=>!!e);m(t||[]),a(-1)},[c]),n.useEffect(()=>{const t=w(()=>{if(!u.current||!s.current.length)return;if(E()===0){a(-1);return}const f=s.current.findIndex((x,g)=>{const p=s.current[g+1],{top:h}=x.getBoundingClientRect(),{top:v}=p?.getBoundingClientRect()||{};return h<=100&&(!p||v>100)});a(f)},50);return window.addEventListener("scroll",t),()=>{window.removeEventListener("scroll",t)}},[]),o.jsxs("div",{ref:u,className:`w-64 pr-7 ${r}`,children:[o.jsx("div",{className:"mb-2 text-xs font-bold",children:"目录"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`absolute -left-3 w-1 h-5 rounded bg-primary transition-all
          ${i>=0?"opacity-100":"opacity-0"}`,style:{top:`${Math.max(i*28,0)+4}px`}}),c?.map((t,e)=>o.jsx(y,{id:I(e),className:`block truncate text-sm leading-7 font-medium transition-opacity
              ${e===i?"opacity-100":"opacity-60 hover:opacity-100"}`,to:`#${t.id}`,style:{paddingLeft:`${(t.depth-2)*12}px`},children:t.text},e))]})]})}function I(r){return`toc-item-${r}`}export{S as Toc,S as default};
