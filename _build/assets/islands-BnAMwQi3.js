import{j as s}from"./jsx-runtime-OjB1YB6s.js";import{u as r}from"./index-Crl2ozBJ.js";const h={commitTime:1727690212},o=[{id:"islands---孤岛架构",text:"islands - 孤岛架构",depth:1},{id:"介绍",text:"介绍",depth:2},{id:"使用",text:"使用",depth:2},{id:"1-配置-alias-island",text:"1. 配置 alias island:",depth:3},{id:"2-定义孤岛组件",text:"2. 定义“孤岛”组件",depth:3},{id:"3-导入并使用孤岛组件",text:"3. 导入并使用“孤岛”组件",depth:3},{id:"水合配置",text:"水合配置",depth:2},{id:"水合时机",text:"水合时机",depth:3},{id:"超时",text:"超时",depth:3},{id:"手动水合",text:"手动水合",depth:2}];function e(l){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...r(),...l.components},{Callout:n}=i;return n||a("Callout"),s.jsxs(s.Fragment,{children:[s.jsx(i.h1,{id:"islands---孤岛架构",children:"islands - 孤岛架构"}),`
`,s.jsx(i.h2,{id:"介绍",children:"介绍"}),`
`,s.jsxs(i.p,{children:["Islands Architecture（孤岛架构）的概念最初在 2019 年被 ",s.jsx(i.a,{href:"https://twitter.com/ksylor",children:"Katie Sylor-Miller"}),` 提出，
然后在 2020 年被 Preact 作者 Jason Miller 在`,s.jsx(i.a,{href:"https://jasonformat.com/islands-architecture/",children:"一篇文章"}),`中进行了推广。
简单来说，孤岛架构将我们的 Web 应用划分为静态和动态部分。其中的`,s.jsx(i.strong,{children:"孤岛"}),"可以独立进行水合，以实现它的交互能力。"]}),`
`,s.jsx(i.p,{children:`但是，也正因为孤岛架构的动静划分，使得它更适合于偏展示的应用，例如博客、文档、静态页面等，而不太适合于偏交互的应用，例如电商、社交...
并且它也提高了应用开发的复杂度和难度。`}),`
`,s.jsxs(i.p,{children:["为了让这项技术更加具有普适性，Servite 做了一些改进，不再要求页面大部分都是静态的，你的页面完全就是可交互的",s.jsx(i.strong,{children:"普通"}),`页面，
只是可以选择性地让某些组件延迟到特定时机才进行水合，甚至不水合。这样也能延迟部分组件 JS 的执行，甚至不下载这部分组件的 JS。`]}),`
`,s.jsx(i.h2,{id:"使用",children:"使用"}),`
`,s.jsxs(i.h3,{id:"1-配置-alias-island",children:["1. 配置 alias ",s.jsx(i.code,{children:"island:"})]}),`
`,s.jsxs(i.p,{children:["为了让 Servite 知道哪些组件是“孤岛”组件，Servite 约定了使用 ",s.jsx(i.code,{children:"island:"}),` 作为导入组件的路径前缀，
所以需要在 `,s.jsx(i.code,{children:"tsconfig.json"})," 中配置相应的 alias："]}),`
`,s.jsx(i.pre,{className:"shiki shiki-themes min-light plastic has-highlighted",style:{backgroundColor:"#ffffff","--shiki-dark-bg":"#21252B",color:"#24292eff","--shiki-dark":"#A9B2C3"},tabIndex:"0",children:s.jsxs(i.code,{children:[s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"{"})}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'  "'}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#C6CCD7"},children:"compilerOptions"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:":"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" {"})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'    "'}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#C6CCD7"},children:"baseUrl"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:":"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:' "'}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},children:"."}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:","})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'    "'}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#C6CCD7"},children:"paths"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:":"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" {"})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'      "'}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#C6CCD7"},children:"@/*"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:":"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" ["}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},children:"./src/*"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"]"}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:","})]}),`
`,s.jsxs(i.span,{className:"line highlighted",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'      "'}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#C6CCD7"},children:"island:*"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:":"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" ["}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},children:"./src/*"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"] "})]}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"    }"})}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"  }"}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:","})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'  "'}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#C6CCD7"},children:"include"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:":"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" ["}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},children:"src"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:'"'}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"]"})]}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"}"})})]})}),`
`,s.jsxs(i.p,{children:["这样，当我们导入 ",s.jsx(i.code,{children:"island:components/Counter"})," 时，Servite 会将 ",s.jsx(i.code,{children:"Counter"})," 组件标记为“孤岛”组件。"]}),`
`,s.jsx(i.h3,{id:"2-定义孤岛组件",children:"2. 定义“孤岛”组件"}),`
`,s.jsxs(i.p,{children:["需要",s.jsx(i.strong,{children:"默认导出"}),"“孤岛”组件。我们可以对组件类型修改如下，以获得更好的类型提示："]}),`
`,s.jsx(i.pre,{className:"shiki shiki-themes min-light plastic has-highlighted",style:{backgroundColor:"#ffffff","--shiki-dark-bg":"#21252B",color:"#24292eff","--shiki-dark":"#A9B2C3"},tabIndex:"0",children:s.jsxs(i.code,{children:[s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#C2C3C5","--shiki-dark":"#5F6672",fontStyle:"inherit","--shiki-dark-font-style":"italic"},children:"// ./components/Counter.tsx"})}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"import"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" { "}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:"IslandProps"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" } "}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"from"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:" '"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},children:"servite/runtime/island"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:"'"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:";"})]}),`
`,s.jsx(i.span,{className:"line"}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#C2C3C5","--shiki-dark":"#5F6672",fontStyle:"inherit","--shiki-dark-font-style":"italic"},children:"// 集成 IslandProps，以获得更好的类型提示"})}),`
`,s.jsxs(i.span,{className:"line highlighted",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"export"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#61AFEF"},children:" interface"}),s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#E5C07B"},children:" CounterProps"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#61AFEF"},children:" extends"}),s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#D19A66"},children:" IslandProps"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" { "})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:"  initial"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"?:"}),s.jsx(i.span,{style:{color:"#1976D2","--shiki-dark":"#E5C07B"},children:" number"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:";"})]}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"}"})}),`
`,s.jsx(i.span,{className:"line"}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#C2C3C5","--shiki-dark":"#5F6672",fontStyle:"inherit","--shiki-dark-font-style":"italic"},children:"// [!] 注意：必须使用默认导出"})}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"export"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:" "}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},className:"highlighted-word",children:"default"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#61AFEF"},children:" function"}),s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#B57EDC"},children:" Counter"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"({ "}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:"initial"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:" ="}),s.jsx(i.span,{style:{color:"#1976D2","--shiki-dark":"#56B6C2"},children:" 0"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" }"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:":"}),s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#E5C07B"},children:" CounterProps"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:") {"})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#61AFEF"},children:"  const"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" ["}),s.jsx(i.span,{style:{color:"#1976D2","--shiki-dark":"#C6CCD7"},children:"count"}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:","}),s.jsx(i.span,{style:{color:"#1976D2","--shiki-dark":"#C6CCD7"},children:" setCount"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"] "}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"="}),s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#B57EDC"},children:" useState"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"("}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:"initial"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:");"})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"  return"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" ("})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"    <"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#E5C07B"},children:"button"}),s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#D19A66"},children:" onClick"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"="}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"{() "}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#61AFEF"},children:"=>"}),s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#B57EDC"},children:" setCount"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"("}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:"count"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:" +"}),s.jsx(i.span,{style:{color:"#1976D2","--shiki-dark":"#56B6C2"},children:" 1"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:")}>"})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"        count: {"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:"count"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"}"})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"    </"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#E5C07B"},children:"button"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:">"})]}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"  );"})}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"}"})})]})}),`
`,s.jsx(i.h3,{id:"3-导入并使用孤岛组件",children:"3. 导入并使用“孤岛”组件"}),`
`,s.jsx(i.pre,{className:"shiki shiki-themes min-light plastic",style:{backgroundColor:"#ffffff","--shiki-dark-bg":"#21252B",color:"#24292eff","--shiki-dark":"#A9B2C3"},tabIndex:"0",children:s.jsxs(i.code,{children:[s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#C2C3C5","--shiki-dark":"#5F6672",fontStyle:"inherit","--shiki-dark-font-style":"italic"},children:"// ./pages/index.tsx"})}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"import"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:" Counter"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:" from"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:" '"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},className:"highlighted-word",children:"island:"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},children:"components/Counter"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:"'"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:";"})]}),`
`,s.jsx(i.span,{className:"line"}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"export"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:" default"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#61AFEF"},children:" function"}),s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#B57EDC"},children:" Index"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"() {"})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"  return"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" ("})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"      <"}),s.jsx(i.span,{style:{color:"#1976D2","--shiki-dark":"#61AFEF"},children:"Counter"})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#D19A66"},children:"        "}),s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#D19A66"},className:"highlighted-word",children:"hydrate"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"="}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"{"})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:"          on"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:": "}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:"'"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},className:"highlighted-word",children:"visible"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:"'"}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:","}),s.jsx(i.span,{style:{color:"#C2C3C5","--shiki-dark":"#5F6672",fontStyle:"inherit","--shiki-dark-font-style":"italic"},children:" // 在组件可见时才进行水合"})]}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"        }}"})}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"      />"})}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"  );"})}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"}"})})]})}),`
`,s.jsx(i.h2,{id:"水合配置",children:"水合配置"}),`
`,s.jsxs(i.p,{children:["上面例子的 ",s.jsx(i.code,{children:"hydrate"})," 属性，是 Servite 提供的“水合”配置。"]}),`
`,s.jsx(i.h3,{id:"水合时机",children:"水合时机"}),`
`,s.jsxs(i.p,{children:[s.jsx(i.code,{children:"hydrate.on"})," 属性支持以下几种配置："]}),`
`,s.jsxs(i.ul,{children:[`
`,s.jsxs(i.li,{children:[s.jsx(i.strong,{children:"load"}),"：在页面加载时立即水合"]}),`
`,s.jsxs(i.li,{children:[s.jsx(i.strong,{children:"idle"}),"：在浏览器空闲时水合"]}),`
`,s.jsxs(i.li,{children:[s.jsx(i.strong,{children:"visible"}),"：在组件可见时水合"]}),`
`,s.jsxs(i.li,{children:[s.jsx(i.strong,{children:"media"}),"：在匹配媒体查询时水合。例如：",s.jsx(i.code,{children:"on: media (prefers-color-scheme: dark)"})," 在黑暗模式才进行水合"]}),`
`,s.jsxs(i.li,{children:[s.jsx(i.strong,{children:"manual"}),"：代码调用 ",s.jsx(i.code,{children:"hydrateIsland"})," 方法手动水合，可自行控制水合时机。"]}),`
`]}),`
`,s.jsx(n,{type:"tip",children:s.jsxs(i.p,{children:["当孤岛组件未指定 ",s.jsx(i.code,{children:"hydrate.on"}),` 时，则永远都不会进行水合，也不会下载相应的组件 JS。
对于不需要交互的静态组件，这种方式能有效减少客户端加载和运行的 JS 体积。`]})}),`
`,s.jsx(i.h3,{id:"超时",children:"超时"}),`
`,s.jsxs(i.p,{children:[s.jsx(i.code,{children:"hydrate.timeout"})," 属性可以配置水合超时时间，单位为毫秒。当超过这个时间时，组件还未水合，则会自动触发水合。"]}),`
`,s.jsx(i.h2,{id:"手动水合",children:"手动水合"}),`
`,s.jsxs(i.p,{children:[s.jsx(i.code,{children:"hydrate.on"})," 配置为 ",s.jsx(i.code,{children:"manual"}),"，可以自动控制水合时机。"]}),`
`,s.jsxs(i.p,{children:["当需要手动水合某个组件时，要给抓紧 ",s.jsx(i.code,{children:"hydrate.id"})," 属性传入 id 值，用于唯一标记该组件，然后在需要时调用 ",s.jsx(i.code,{children:"hydrateIsland(id)"})," 方法即可："]}),`
`,s.jsx(i.pre,{className:"shiki shiki-themes min-light plastic has-focused",style:{backgroundColor:"#ffffff","--shiki-dark-bg":"#21252B",color:"#24292eff","--shiki-dark":"#A9B2C3"},tabIndex:"0",children:s.jsxs(i.code,{children:[s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#C2C3C5","--shiki-dark":"#5F6672",fontStyle:"inherit","--shiki-dark-font-style":"italic"},children:"// ./pages/index.tsx"})}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"import"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:" Counter"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:" from"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:" '"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},children:"island:components/Counter"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:"'"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:";"})]}),`
`,s.jsx(i.span,{className:"line"}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"export"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:" default"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#61AFEF"},children:" function"}),s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#B57EDC"},children:" Index"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"() {"})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"  return"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:" ("})]}),`
`,s.jsxs(i.span,{className:"line",children:[s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"      <"}),s.jsx(i.span,{style:{color:"#1976D2","--shiki-dark":"#61AFEF"},children:"Counter"})]}),`
`,s.jsxs(i.span,{className:"line focused",children:[s.jsx(i.span,{style:{color:"#6F42C1","--shiki-dark":"#D19A66"},children:"        hydrate"}),s.jsx(i.span,{style:{color:"#D32F2F","--shiki-dark":"#E06C75"},children:"="}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"{ "})]}),`
`,s.jsxs(i.span,{className:"line focused",children:[s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:"          on"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:": "}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:"'"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},className:"highlighted-word",children:"manual"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:"'"}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:","}),s.jsx(i.span,{style:{color:"#C2C3C5","--shiki-dark":"#5F6672",fontStyle:"inherit","--shiki-dark-font-style":"italic"},children:" // 在组件可见时才进行水合"})]}),`
`,s.jsxs(i.span,{className:"line focused",children:[s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#C6CCD7"},children:"          id"}),s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:": "}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:"'"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},children:"my-"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#98C379"},className:"highlighted-word",children:"counter"}),s.jsx(i.span,{style:{color:"#22863A","--shiki-dark":"#A9B2C3"},children:"'"}),s.jsx(i.span,{style:{color:"#212121","--shiki-dark":"#A9B2C3"},children:","}),s.jsx(i.span,{style:{color:"#C2C3C5","--shiki-dark":"#5F6672",fontStyle:"inherit","--shiki-dark-font-style":"italic"},children:" // 组件 id，用于唯一标记该组件"})]}),`
`,s.jsx(i.span,{className:"line focused",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"        }} "})}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"      />"})}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"  );"})}),`
`,s.jsx(i.span,{className:"line",children:s.jsx(i.span,{style:{color:"#24292EFF","--shiki-dark":"#A9B2C3"},children:"}"})})]})}),`
`,s.jsxs(i.p,{children:["然后在代码里自行控制调用 ",s.jsx(i.code,{children:"hydrateIsland('my-counter')"}),"。"]}),`
`,s.jsx(n,{type:"tip",children:s.jsxs(i.p,{children:["如果需要水合全部 ",s.jsx(i.code,{children:"manual"})," 的组件，可以调用 ",s.jsx(i.code,{children:"hydrateIsland(true)"}),"。"]})})]})}function t(l={}){const{wrapper:i}={...r(),...l.components};return i?s.jsx(i,{...l,children:s.jsx(e,{...l})}):e(l)}function a(l,i){throw new Error("Expected component `"+l+"` to be defined: you likely forgot to import, pass, or provide it.")}export{t as default,h as frontmatter,o as toc};
